#!/bin/bash

################################################################################
#                                                                              #
#                                 {o,o}                                        #
#                                 |)__)                                        #
#                                 -"-"-                                        #
#                                                                              #
################################################################################
#
# Looks at backup configs and list backed up files
#
##############################---VARIABLES---###################################

BACKUP_STATUS=0
FILE_LIST_DIR="/opt/backup/file_list"

################################################################################

###############################---WORKDIR---####################################

cd $( dirname $0 )

################################################################################

##############################---FUNCTIONS---###################################

function chackForBackup() {
  mkdir "${FILE_LIST_DIR}"
  for backup in *.conf
  do
    . "./${backup}"
    . "${BACKUP_BACKEND}.cf"
    echo "Collection status for ${BACKUP_NAME}: "
    duplicity list-current-files $DESTINATION_URL | tee "${FILE_LIST_DIR}/${BACKUP_NAME}"
  done
  exit ${BACKUP_STATUS}
}

################################################################################

###############################---EXECUTION---##################################

chackForBackup

################################################################################
